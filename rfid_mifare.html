<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>    RC522 射频 IC 感应模块
</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
            <link rel="stylesheet" href="https://magicalboy.com/theme/css/normalize.css">
        <link href='//fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://magicalboy.com/theme/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://magicalboy.com/theme/css/main.css">

    <link rel="stylesheet" href="https://magicalboy.com/theme/css/blog.css">
    <link rel="stylesheet" href="https://magicalboy.com/theme/css/github.css">
        <link href="https://magicalboy.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="MAG's Note Atom Feed" />
        <script src="https://magicalboy.com/theme/js/vendor/modernizr-2.6.2.min.js"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

        <div id="wrapper">
<header id="sidebar" class="side-shadow">
    <hgroup id="site-header">
        <a id="site-title" href="https://magicalboy.com"><h1><i class="icon-mobile-phone"></i> Donly</h1></a>
        <p id="site-desc"> iOS/macOS/IoT/Web/Game </p>
    </hgroup>
    <nav>
        <ul id="nav-links">
                <li><a href="https://magicalboy.com/pages/about.html">关于</a></li>
                <li><a href="https://magicalboy.com/pages/site-log.html">网站日志</a></li>
        </ul>
    </nav>
	<nav>
      <!-- <ul>
          <li><a target="_blank" href="https://magicalboy.com">MAGICALBOY</a></li>
          <li><a href="https://github.com/donly">icon-github</a></li>
          <li><a href="mailto:donly@magicalboy.com">icon-envelope-alt</a></li>
          <li><a href="atom.xml">icon-rss</a></li>
      </ul> -->
      <ul id="nav-services" class="centered-nav">
              <li><a href="https://github.com/donly" target="_brank"><i class="icon-github svc-badge"></i></a></li>
              <li><a href="mailto:donly@magicalboy.com" target="_brank"><i class="icon-envelope-alt svc-badge"></i></a></li>
              <li><a href="atom.xml" target="_brank"><i class="icon-rss svc-badge"></i></a></li>
      </ul>
	</nav>
</header>
    <div id="post-container">
        <ol id="post-list">
            <li>
                <article class="post-entry">
                    <header class="entry-header">
                        <a href="https://magicalboy.com/rfid_mifare.html" rel="bookmark"><h1>RC522 射频 IC 感应模块</h1></a>
                        <time class="post-time" datetime="2022-05-13T15:30:00+08:00" pubdate>
                            Published: 2022-05-13
                        </time>
                    </header>

                    <section class="post-content">
                        <p>RC522 RFID 读写模块是一个普遍的、适合入门的选择。这里会简单地介绍模块的特点，和 Arduino Uno 连接使用，复制公司的门禁卡贴到手机壳上方便使用，避免了经常忘带卡的尴尬。</p>
<p><img alt="RC522" src="images/arduino/RC522.jpg"></p>
<p>注意这个模块的版本号，中国版的模块可能有功能缺失或使用不正常的问题，详见：https://github.com/miguelbalboa/rfid/wiki/Chinese_RFID-RC522。我购买的这块固件版本号是 v2.0，使用 MFRC522 库可以检测：<code>Firmware Version: 0x92 = v2.0</code> 。</p>
<h2>相关术语介绍</h2>
<ul>
<li>
<p><code>RFID</code>: 射频识别（英语：Radio Frequency IDentification）是一种无线通信技术。</p>
</li>
<li>
<p><code>MIFARE</code>: 是恩智浦半导体公司（NXP Semiconductors）拥有的一系列非接触式智能卡和近傍型卡技术的注册商标。MIFARE包括一系列依循ISO/IEC 14443-A规格，利用无线射频识别（频率为13.56MHz）的多种非接触式智能卡专有解决方案。</p>
</li>
<li>
<p><code>UID</code>：唯一标识符（Unique Identifier）</p>
</li>
<li><code>RID</code>：安全随机标识符（Random Security Identifier）</li>
<li><code>PICC</code>: Proximity Integrated Circuit (“Contactless Card”)，感应集成电路（“非接触式卡”）</li>
<li><code>SAK</code>: Select Acknowledge, Type A </li>
</ul>
<h2>主要特点</h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Frequency Range</td>
<td>13.56 MHz ISM Band</td>
</tr>
<tr>
<td>Host Interface</td>
<td>SPI / I2C / UART</td>
</tr>
<tr>
<td>Operating Supply Voltage</td>
<td>2.5 V to 3.3 V</td>
</tr>
<tr>
<td>Max. Operating Current</td>
<td>13-26mA</td>
</tr>
<tr>
<td>Standby current</td>
<td>10-13mA</td>
</tr>
<tr>
<td>Min. Current(Power down)</td>
<td>10µA</td>
</tr>
<tr>
<td>Logic Inputs</td>
<td>5V Tolerant</td>
</tr>
<tr>
<td>Read Range</td>
<td>0~60mm</td>
</tr>
<tr>
<td>Programmer timer</td>
<td></td>
</tr>
<tr>
<td>Internal self-test</td>
<td></td>
</tr>
<tr>
<td>FIFO buffer</td>
<td></td>
</tr>
<tr>
<td>Highly integrated analog circuitry</td>
<td></td>
</tr>
<tr>
<td>CRC co-processor</td>
<td></td>
</tr>
</tbody>
</table>
<h2>Pinout</h2>
<p><img alt="RC522 Pinout" src="images/arduino/RC522_pinout.png"></p>
<ul>
<li>
<p>VCC supplies power for the module. This can be anywhere from 2.5 to 3.3 volts. You can connect it to 3.3V output from your Arduino. Remember connecting it to 5V pin will likely destroy your module!</p>
</li>
<li>
<p>RST is an input for Reset and power-down. When this pin goes low, hard power-down is enabled. This turns off all internal current sinks including the oscillator and the input pins are disconnected from the outside world. On the rising edge, the module is reset.</p>
</li>
<li>
<p>GND is the Ground Pin and needs to be connected to GND pin on the Arduino.</p>
</li>
<li>
<p>IRQ is an interrupt pin that can alert the microcontroller when RFID tag comes into its vicinity.</p>
</li>
<li>
<p>MISO / SCL / Tx pin acts as Master-In-Slave-Out when SPI interface is enabled, acts as serial clock when I2C interface is enabled and acts as serial data output when UART interface is enabled.</p>
</li>
<li>
<p>MOSI (Master Out Slave In) is SPI input to the RC522 module.</p>
</li>
<li>
<p>SCK (Serial Clock) accepts clock pulses provided by the SPI bus Master i.e. Arduino.</p>
</li>
<li>
<p>SS / SDA / Rx pin acts as Signal input when SPI interface is enabled, acts as serial data when I2C interface is enabled and acts as serial data input when UART interface is enabled. This pin is usually marked by encasing the pin in a square so it can be used as a reference for identifying the other pins.</p>
</li>
</ul>
<h2>接线</h2>
<p><img alt="RC522 Connection" src="images/arduino/rc522_arduino_connection.png"></p>
<div class="highlight"><pre><span></span><code><span class="n">RC522</span> <span class="o">-</span>  <span class="n">Arduino</span>
<span class="n">MISO</span> <span class="o">&lt;-&gt;</span> <span class="n">D12</span>
<span class="n">RST</span>  <span class="o">&lt;-&gt;</span> <span class="n">D9</span>
<span class="n">MOSI</span> <span class="o">&lt;-&gt;</span> <span class="n">D11</span>
<span class="n">SCK</span>  <span class="o">&lt;-&gt;</span> <span class="n">D13</span>
<span class="n">IRQ</span>  <span class="o">&lt;-&gt;</span> <span class="n">Not</span> <span class="n">connected</span>
<span class="n">SDA</span>  <span class="o">&lt;-&gt;</span> <span class="n">D10</span>
<span class="n">GND</span>  <span class="o">&lt;-&gt;</span> <span class="n">GND</span>
<span class="m">3.3</span><span class="n">V</span> <span class="o">&lt;-&gt;</span> <span class="m">3.3</span><span class="n">V</span>
</code></pre></div>

<p>图中的 OLED 屏模块没有用到可以忽略。</p>
<h2>安装 Arduino MFRC522 库</h2>
<p>直接打开 Arduino 软件在库中搜索 RC522，安装这个库 https://github.com/miguelbalboa/rfid。</p>
<p><img alt="RC522 Library" src="images/arduino/nfrc522_lib.png"></p>
<h2>打开库自带例程</h2>
<p>先打开 <code>DumpInfo</code> 项目读取公司门禁卡的 UID，读到的数据如下：</p>
<div class="highlight"><pre><span></span><code>Card UID: 8C 1A B9 1F
Card SAK: <span class="m">08</span>
PICC type: MIFARE 1KB
...
</code></pre></div>

<p>再打开 <code>ChangeUID</code> Example 项目，修改这一行代码为自己要改的新 UID：</p>
<div class="highlight"><pre><span></span><code><span class="cm">/* Set your new UID here! */</span><span class="w"></span>
<span class="k">constexpr</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">newUid</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mh">0x8C</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1A</span><span class="p">,</span><span class="w"> </span><span class="mh">0xB9</span><span class="p">,</span><span class="w"> </span><span class="mh">0x1F</span><span class="p">};</span><span class="w"></span>
</code></pre></div>

<p>编译上传到 Arduino Uno。</p>
<h2>复制到新卡贴</h2>
<p>直接将新卡贴放到感应区上完成 UID 的修改。注意：必须购买可以修改 0 扇区的 UID 卡贴，否则会修改失败，相当于什么也没发生。</p>
<h2>其它参考</h2>
<ul>
<li>https://lastminuteengineers.com/how-rfid-works-rc522-arduino-tutorial/</li>
<li>https://zh.wikipedia.org/wiki/MIFARE</li>
<li>https://www.nxp.com/docs/en/data-sheet/MF1S50YYX_V1.pdf</li>
<li>https://fanzheng.org/archives/30</li>
</ul>
                    </section>
                    <hr/>
                    <aside class="post-meta">
                        <p>Category: <a href="https://magicalboy.com/category/misc.html">misc</a></p>
                        <p>Tags: <a href="https://magicalboy.com/tag/arduino.html">arduino</a>, <a href="https://magicalboy.com/tag/rfid.html">rfid</a>, <a href="https://magicalboy.com/tag/mifare.html">mifare</a>, </p>
                        <p>Copyright: <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh/">自由转载-非商用-非衍生-保持署名（创意共享3.0许可证）</a></p>
                    </aside>
                    <hr/>
<div class="comments">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'magsnote';
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
                </article>
            </li>
        </ol>
    </div>
        </div>
<footer id="site-info">
    <p>
        Proudly powered by <a href="http://getpelican.com/" target="pelican">Pelican</a> and <a href="http://python.org/" target="python">Python</a>. Theme base on <a href="https://github.com/hdra/pelican-cait" target="github">hndr</a>.
    </p>
    <p>
        Textures by <a href="http://subtlepatterns.com/" target="subtlepatterns">Subtle Pattern</a>. Font Awesome by <a href="http://fortawesome.github.io/Font-Awesome/" target="github">Dave Grandy</a>.
    </p>
</footer>        <script src="https://magicalboy.com/theme/js/main.js"></script>
    </body>
</html>